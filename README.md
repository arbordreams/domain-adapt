this took a long time
